function is_defined(e){return null!=e&&void 0!=e}function get_url_parameters(){var e=arguments.length>0?arguments[0]:window.location.href,t={},r=e.indexOf("#");if(r>=0)for(var a=e.slice(r+1).split("&"),n=0;n<a.length;n++){var i=a[n].split("=");t[i[0]]=i[1]}return t}function fill_from_repr(e){for(var t=e.split(";"),r=arguments.length>1?arguments[1]:null,a=0;a<t.length;a++)if(is_defined(t[a])&&""!=t[a]){var n=$.map(t[a].split(","),function(e){var t=e.split(":"),a=POSSIBLE_COLORS[t[1]];return null!=r&&a!=r?null:[[t[0],a]]});show_notes_string(a,n)}}var CHECKANSWER="Check Answer!",GTR_FRETS=19,GTR_STRINGS=6,GUITAR_STRINGS,INTERVAL_COLORS=["i_root","i_flatnine","i_nine","i_flatthird","i_third","i_fourth","i_flatfifth","i_fifth","i_flatsixth","i_sixth","i_flatseventh","i_seventh","i_passing","white","black"],PALLETE_COLORS=["orange","green","blue","yellow","lightgreen","red","transparent"],POSSIBLE_COLORS=INTERVAL_COLORS.concat(PALLETE_COLORS),ERASER=!1,BRUSH=!1,SETTINGROOT=!1,ST_QUIZZING_INTERVAL="QUIZZING_INTERVAL",ST_QUIZZING_RANDOMROOT="QUIZZING_RANDOMROOT",ST_QUIZZING_URL="QUIZZING_URL",ST_QUIZZING_NONE="QUIZZING_NONE",QUIZZING=ST_QUIZZING_NONE,CHECKING_URL_QUIZ=!1,INTERVALMODE=!1,COLORBYINTERVALS=!1,COLOR="lightgreen",KEY=0,mFB=FretboardModel,mPlayer=PlayerModel,gen_fret_boxes=function(e,t){for(var r="<tr>",a=0;e>a;a++)r+='<td class="transparent"><span class="note"></span></td>';r+="</tr>";for(var n='<table id="fretclone">',a=0;t>a;a++)n+=r;return n+="</table>"},td_paint=function(e){var t=arguments.length>1?arguments[1]:"lightgreen",e=$(e);e.removeClass(POSSIBLE_COLORS.join(" ")),e.addClass(t)},td_clear=function(e){td_paint(e,"transparent")},is_painted=function(e){!$(e).hasClass("transparent");return!$(e).hasClass("transparent")},note_paint=function(e,t){$.isArray(t)?td_paint(GUITAR_STRINGS[e][t[0]].td,t[1]):td_paint(GUITAR_STRINGS[e][t].td)},uri_diagram_repr=function(e){var t=$.map(e,function(e){var t=$.map(e,function(e,t){if(is_painted(e.td)){var r=$(e.td).attr("class");return t+":"+POSSIBLE_COLORS.indexOf(r)}return null});return t.join(",")});return t.join(";")},getArrNotegroupsInDash=function(){var e="",t=$("#ngDashboard").children(".cNoteGroup");if(t.length>0)for(var r=0;r<t.length;r++)e+=$(t[r]).attr("notegroup")+",";return e=e.replace(/,+$/,"")},create_link_from_fretboard=function(){var e=window.location.href;e.indexOf("#")>0&&(e=e.substring(0,e.indexOf("#"))),e+="#",e+="strings="+uri_diagram_repr(GUITAR_STRINGS),e+="&key="+mFB.getKeyObj().safename,e+="&displayKey="+mFB.getNotesDisplayKey().safename,e+="&ng="+mFB.getNotegroup().varname,e+="&intColor="+COLORBYINTERVALS,e+="&intNames="+INTERVALMODE,e+="&diagram_title="+escape($("#diagram_title").val());var t=getArrNotegroupsInDash();return""!=t&&(e+="&dash="+t),e},update_link=function(){$("#linkthis").attr("href",create_link_from_fretboard()),$("#linkquiz").attr("href",create_link_from_fretboard()+"&q=y")},td_paint_or_clear=function(e){var e=$(e);if(e.hasClass("transparent")||!e.hasClass(COLOR)&&!COLORBYINTERVALS)if(COLORBYINTERVALS){var t=getStringFret(e);ctl_color_td_by_interval(t[0],t[1])}else td_paint(e,COLOR);else e.removeClass(POSSIBLE_COLORS.join(" ")),e.addClass("transparent")},getFretcloneStrings=function(){for(var e=$("#fretclone tr"),t=[[],[],[],[],[],[]],r=0;r<e.length;r++)for(var a=e[r].children,n=0;n<a.length;n++){var i={td:a[n],paint:function(){if(SETTINGROOT){SETTINGROOT=!1,updateSetRootView();var e=$(this).attr("notename");ctl_change_key.setRoot(getKeyObjFromNoteName(e)),td_clear(this)}td_paint_or_clear(this,COLOR)}};t[r].push(i),$(a[n]).click(i.paint),$(a[n]).mouseover(function(){if(1==ERASER)td_clear(this),update_link();else if(1==BRUSH)if(COLORBYINTERVALS){var e=this.id.split("_");ctl_color_td_by_interval(e[1],e[2]),update_link()}else td_paint(this,COLOR),update_link()})}return t},show_notes_string=function(e,t){if(null!=t)for(var r=0;r<t.length;r++)null!=t[r]&&note_paint(e,t[r])},show_chord=function(e){for(var t=0;t<e.length;t++)show_notes_string(t,[e[t]])},show_scale=function(e){for(var t=0;t<e.length;t++)null!=e[t]&&show_notes_string(t,e[t])},check_answers=function(e){for(var t=e.split(";"),r=0;r<t.length;r++)if(is_defined(t[r])&&""!=t[r])for(var a=$.map(t[r].split(","),function(e){return[e.split(":")[0]]}),n=0;n<GUITAR_STRINGS[r].length;n++)if($.inArray(n.toString(),a)>=0){var i=is_painted(GUITAR_STRINGS[r][n].td)?"lightgreen":"orange";note_paint(r,[n,i])}else is_painted(GUITAR_STRINGS[r][n].td)&&note_paint(r,[n,"red"])},clear_fretboard=function(){for(var e=0;e<GUITAR_STRINGS.length;e++)for(var t=0;t<GUITAR_STRINGS[e].length;t++)td_clear(GUITAR_STRINGS[e][t].td);QUIZZING==ST_QUIZZING_INTERVAL&&ctl_updateQuizzing(ST_QUIZZING_NONE),ctrl_updateMessage()},pick_note=function(e,t){return"undefined"==typeof t&&(t=0),"undefined"==typeof e&&(e=4),mFB.getChromNames()[(e+t)%mFB.getChromNames().length]},set_notes=function(){for(var e=[4,11,7,2,9,4],t=0;t<GUITAR_STRINGS.length;t++)for(var r=0;r<GUITAR_STRINGS[t].length;r++){var a=$(GUITAR_STRINGS[t][r].td),n=$(GUITAR_STRINGS[t][r].td).find(".note"),i=pick_note(r,e[t]);n.attr("id","ns_"+t+"_"+r),a.attr("id","nc_"+t+"_"+r),n.attr("notename",i),a.attr("notename",i),n.html($("#ns_"+t+"_"+r).attr("notename"));var o=(r+e[t])%mFB.getChromNames().length;a.attr("semiInts",o),n.attr("semiInts",o)}},set_notespans=function(e){for(var t=0;t<GUITAR_STRINGS.length;t++)for(var r=0;r<GUITAR_STRINGS[t].length;r++){var a=$("#ns_"+t+"_"+r);a.attr("id","ns_"+t+"_"+r);var n=(a.attr("notename"),mFB.getNGintnames().length,(mFB.getNGintnames().length+Number(a.attr("semiInts"))-mFB.getKeyInt())%mFB.getNGintnames().length);if(a.html(INTERVALMODE?0==n?mFB.getChromNames()[0]:mFB.getNGintnames()[n]:mFB.getNotesDisplayChromnames()[Number(a.attr("semiInts"))]),e){{is_painted($("#nc_"+t+"_"+r))}COLORBYINTERVALS&&is_painted($("#nc_"+t+"_"+r))&&ctl_color_td_by_interval(t,r)}}ctrl_updateMessage()},ctrl_updateMessage=function(){if(COLORBYINTERVALS){var e="Painting notes for <strong>"+mFB.getKeyTextName();mFB.getNotegroupDict()!=dictArps&&(e+=" "),e+=mFB.getNotegroup().name+"</strong>",e+=" in key of "+mFB.getNotesDisplayKey().name,$("#message").html(e)}else $("#message").html(CHECKING_URL_QUIZ?'<span style="color:red">Click notes to answer quiz, the press "Check Quiz Answer!"</style>':"")},ctl_updateIntervalMode=function(e){e?($("#modeNoteInt").attr("value","Display Notes"),INTERVALMODE=!0,set_notespans(!0),update_link()):($("#modeNoteInt").attr("value","Display Intervals"),INTERVALMODE=!1,set_notespans(!0),update_link()),(QUIZZING==ST_QUIZZING_RANDOMROOT||QUIZZING==ST_QUIZZING_INTERVAL)&&ctl_updateQuizzing(ST_QUIZZING_NONE)},ctl_populateDash=function(e){for(var t=e.split(","),r=0;r<t.length;r++)ctrl_addDashNotegroups(t[r])},ctrl_addDashNotegroups=function(e){var t,r=e.split("_"),a=(r[0],r[1]),n=r[2],i=getKeyObjFromSafeName(r[0]).name;switch(a){case"ARP":i+=dictArps[a+"_"+n].name,t="ngboxArp";break;case"SC":i+=" "+dictScales[a+"_"+n].name,t="ngboxScale";break;case"CHD":i+=" "+dictChords[a+"_"+n].name,t="ngboxChd"}var o=$("<div>",{"class":"cNoteGroup "+t,notegroup:e}).html(i);o.dblclick(function(){ctl_stopPlayer(),$(this).remove()}).click(function(){set_notes_per_notegroup(r[0],r[1],r[2])}),mPlayer.getPlaystate()==PS_PLAYING&&ctl_stopPlayer(),$("#ngDashboard").append(o),$("#ngDashboard").sortable({stop:function(){mPlayer.reloadNotegroups($("#ngDashboard")),update_link()},start:function(){ctl_stopPlayer()}}),mPlayer.reloadNotegroups($("#ngDashboard")),update_link()},ctl_updateColorIntMode=function(e){e?(COLORBYINTERVALS=!0,$("#colorByInterval").attr("value","Pallete Color"),$("#colorchooser").hide(),set_notespans(!0),update_link()):(COLORBYINTERVALS=!1,$("#colorByInterval").attr("value","Color Intervals"),$("#colorchooser").show(),set_notespans(!0),update_link())},ctl_color_td_by_interval=function(e,t){var r=(mFB.getNGintnames().length+Number($("#ns_"+e+"_"+t).attr("semiInts"))-mFB.getKeyInt())%mFB.getNGintnames().length,a=mFB.getNGintcolor()[Number(r)];td_paint($("#nc_"+e+"_"+t),a)},ctl_change_key={setRoot:function(e){mFB.setKey(e,!1),$("#selKey").val()!=e.safename&&$("#selKey").val(e.safename),set_notespans(!0)},keyChangeNotegroup:function(e){mFB.setKey(dictKeys[e],!1)},selKeyChange:function(e){mFB.setKey(dictKeys[e],!0),set_notespans(!1),update_link()}},ctl_updateQuizzing=function(e){switch(QUIZZING=e,e){case ST_QUIZZING_INTERVAL:ctl_newIntQuiz(),$("#intervalQuiz").attr("value",CHECKANSWER);break;case ST_QUIZZING_URL:$("#colorchooser").hide(),$("#checkanswer").show();break;case ST_QUIZZING_RANDOMROOT:ctl_newRandRoot();break;case ST_QUIZZING_NONE:$("#intervalQuiz").attr("value","Random Interval"),$("#randomRootQuiz").attr("value","Random Root"),$("#checkanswer").hide()}},ctl_newIntQuiz=function(){clear_fretboard(),INTERVALMODE=!1;for(var e=mPref.aPrefs.riq_LoFret,t=mPref.aPrefs.riq_HiFret,r=mPref.aPrefs.riq_FretDepth,a=mPref.aPrefs.riq_StrDepth,n=Math.floor(Math.random()*GUITAR_STRINGS.length),i=Math.floor(Math.random()*GUITAR_STRINGS.length),o=randomIntFromInterval(e,t);Math.abs(i-n)>a;)i=randomIntFromInterval(0,GUITAR_STRINGS.length);var s,l;for(s=e>o-r?e:o-r,l=o+r>t?t:o+r,intFret=randomIntFromInterval(s,l);i==n&&o==intFret||e>intFret||intFret>t;)intFret=randomIntFromInterval(s,l);var _=$("#ns_"+n+"_"+o).attr("notename");ctl_change_key.setRoot(getKeyObjFromNoteName(_)),$("#ns_"+n+"_"+o).text("R"),td_paint("#nc_"+n+"_"+o,"red"),$("#ns_"+i+"_"+intFret).text(" "),td_paint("#nc_"+i+"_"+intFret,"lightgreen")},ctl_newRandRoot=function(){clear_fretboard();for(var e=mPref.aPrefs.rrq_LoFret,t=mPref.aPrefs.rrq_HiFret,r=mPref.aPrefs.rrq_LoStr-1,a=mPref.aPrefs.rrq_HiStr-1,n=[-1,-1];!(n[0]>=r&&n[0]<=a);)n[0]=Math.floor(Math.random()*GUITAR_STRINGS.length);for(;!(n[1]>=e&&n[1]<=t);)n[1]=Math.floor(Math.random()*t);td_paint("#nc_"+n[0]+"_"+n[1],"red");var i=getKeyObjFromNoteName($("#nc_"+n[0]+"_"+n[1]).attr("notename")).safename;checkedNG=[];for(ng in mPref.aPrefs.rrq_Notegroups)mPref.aPrefs.rrq_Notegroups[ng][1]&&checkedNG.push(mPref.aPrefs.rrq_Notegroups[ng][0]);var o=checkedNG[Math.floor(Math.random()*checkedNG.length)].split("_");set_notes_per_notegroup(i,o[0],o[1])},ctl_updateRRQnotegroupsToPrefModel=function(){for(var e in mPref.aPrefs.rrq_Notegroups)mPref.aPrefs.rrq_Notegroups[e][1]?$("#prefRRQ_"+mPref.aPrefs.rrq_Notegroups[e][0]).prop("checked",!0):$("#prefRRQ_"+mPref.aPrefs.rrq_Notegroups[e][0]).prop("checked",!1)},ctl_setPrefFormToPrefModel=function(){$("#spRIQ_LoFret").spinner("value",mPref.aPrefs.riq_LoFret),$("#spRIQ_HiFret").spinner("value",mPref.aPrefs.riq_HiFret),$("#spRIQ_StrDepth").spinner("value",mPref.aPrefs.riq_StrDepth),$("#spRIQ_FretDepth").spinner("value",mPref.aPrefs.riq_FretDepth),$("#spRR_LoFret").spinner("value",mPref.aPrefs.rrq_LoFret),$("#spRR_HiFret").spinner("value",mPref.aPrefs.rrq_HiFret),$("#spRR_LoStr").spinner("value",mPref.aPrefs.rrq_LoStr),$("#spRR_HiStr").spinner("value",mPref.aPrefs.rrq_HiStr),ctl_updateRRQnotegroupsToPrefModel()},ctl_updatePrefs=function(){mPref.rrq_LoFret=$("#spRR_LoFret").spinner("value"),mPref.rrq_HiFret=$("#spRR_HiFret").spinner("value"),mPref.writePrefCookie()},ctl_resetDefaultPrefs=function(){mPref.removePrefCookie(),mPref.init(dictScales,GUITAR_STRINGS[0].length,GUITAR_STRINGS.length),mPref.checkAllNotegroups(),ctl_setPrefFormToPrefModel(),mPref.writePrefCookie()},get_random_stringFret=function(){var e=0,t=GUITAR_STRINGS[0].length,r=[-1,-1];for(r[0]=Math.floor(Math.random()*GUITAR_STRINGS.length);!(r[1]>=e&&r[1]<=t);)r[1]=Math.floor(Math.random()*t);return r},get_random_scale_notegroup_key=function(){var e=Object.keys(dictScales),t=Math.floor(Math.random()*e.length);return e[t]},set_notes_per_notegroup=function(e,t,r){var a=!COLORBYINTERVALS;COLORBYINTERVALS=!0,ctl_change_key.keyChangeNotegroup(e);var r=t+"_"+r;mFB.setNotegroup(r),set_notespans(!0),ctl_updateQuizzing(ST_QUIZZING_NONE),COLORBYINTERVALS=!a},isPalleteColor=function(e){for(var t in PALLETE_COLORS)if(e==t)return!0;return!1},getChromaticInt=function(e,t){null==t&&(t=mFB.getChromNames());for(var r=0;r<t.length;r++)if(e==t[r])return r},getEnharmonic=function(e){if(e.length>1)switch(getAccTypeStr(e),getAccTypeStr(e)){case FLATTED:enStr=acc[0]+"&#9837;",e=CHROMSHARP[getChromaticInt(enStr,CHROMFLAT)];break;case SHARPED:enStr=acc[0]+"&#9839;",e=CHROMFLAT[getChromaticInt(enStr,CHROMSHARP)];break;default:e=e.charAt(0)}return e},getAccTypeStr=function(e){var t,r=escape(e).split("%");switch(r[1]){case"u266D":t=FLATTED;break;case"u266F":t=SHARPED;break;default:t=NATURAL}return t},getKeyObjFromNoteName=function(e){var t=getKeyObjFromUnsafeName(e).fromC,r=mFB.getKeyObj().baseScale[t];return getKeyObjFromUnsafeName(r)},getSafeNameFromNoteName=function(e){var t=getKeyObjFromUnsafeName(e).fromC,r=mFB.getKeyObj().baseScale[t];return getKeyObjFromUnsafeName(r).safename},getKeyObjFromSafeName=function(e){var t="";for(ko in dictKeys)if(e==dictKeys[ko].safename){t=dictKeys[ko];break}return t},getKeyObjFromUnsafeName=function(e){var t="";for(ko in dictKeys)if(e==dictKeys[ko].name){t=dictKeys[ko];break}if(""==t){for(var r=0;r<CHROMSHARP.length;r++)if(e==CHROMSHARP[r]){e=CHROMFLAT[r];break}for(ko in dictKeys)if(e==dictKeys[ko].name){t=dictKeys[ko];break}}return t},getNotespanFromTD=function(e){var t=e.attr("id").split("_");return $("#ns_"+t[1]+"_"+t[2])},getStringFret=function(e){var t=e.attr("id").split("_");return t.shift(),t},updateSetRootView=function(){SETTINGROOT?$("#setRoot").addClass("setRootArmed"):($("#setRoot").removeClass("setRootArmed"),(QUIZZING==ST_QUIZZING_RANDOMROOT||QUIZZING==ST_QUIZZING_INTERVAL)&&ctl_updateQuizzing(ST_QUIZZING_NONE))},populateColorPalleteChooser=function(){html="Palette:";for(var e=0;e<PALLETE_COLORS.length;e++)html+='<input type="button" value="&nbsp;" class="color_button '+PALLETE_COLORS[e]+'" />';$("#colorchooser").append(html)},populateNotegroupsUnabridged=function(){var e='<ul id="unabridgedKeyTabs">';for(var t in dictKeys)e+='<li><a href="#tb_'+dictKeys[t].safename+'">'+dictKeys[t].name+"</a></li>";e+="</ul>",$("#notegroupsUnabridged").append(e),e="";for(var t in dictKeys){e+='<div id="tb_'+dictKeys[t].safename+'" class="tabs-nobg">',e+='<div id="ngTab_'+dictKeys[t].safename+'" class="tabs-nohdr">',e+="<ul  >",e+='<li><a href="#tb_scales_'+dictKeys[t].safename+'">Scales</a></li>',e+='<li><a href="#tb_arppegios_'+dictKeys[t].safename+'">Arpeggios</a></li>',e+='<li><a href="#tb_chords_'+dictKeys[t].safename+'">Chords</a></li>',e+="</ul>",e+='<div id="tb_arppegios_'+dictKeys[t].safename+'" class="tabs-nobg ngExchange">';for(var r in dictArps)e+='<div id="'+dictKeys[t].safename+"_"+r+'" class="ngUnabDiv ngboxArp">',e+=dictKeys[t].name+dictArps[r].name,e+="</div>";e+="</div>",e+='<div id="tb_scales_'+dictKeys[t].safename+'" class="tabs-nobg  ngExchange">';for(var r in dictScales)e+='<div id="'+dictKeys[t].safename+"_"+r+'" class="ngUnabDiv ngboxScale">',e+=dictKeys[t].name+" "+dictScales[r].name,e+="</div>";e+="</div>",e+='<div id="tb_chords_'+dictKeys[t].safename+'" class="tabs-nobg ngExchange">',e+="Maybe in the next update!",e+="</div>",e+="</div>",e+="</div>"}$("#notegroupsUnabridged").append(e)},populateNotegroupsRandRootTab=function(){var e=7,t=0;html="",html+='<span class="RR_scaleOptionsCol">';for(var r in mPref.aPrefs.rrq_Notegroups)t+=1,t>e&&(html+='</span><span class="RR_scaleOptionsCol">',t=1),r=dictScales[mPref.aPrefs.rrq_Notegroups[r][0]],html+='<input type="checkbox" id="prefRRQ_'+r.ngtype+"_"+r.varname+'" name="'+r.ngtype+"_"+r.varname+'" value="'+r.ngtype+"_"+r.varname+'"> '+r.name+"<br>";html+="</span>",$("#RR_scaleOptionsDiv").append(html);for(var r in mPref.aPrefs.rrq_Notegroups)$("#prefRRQ_"+mPref.aPrefs.rrq_Notegroups[r][0]).click(function(){oneRRQalwaysChecked(this)})},randomIntFromInterval=function(e,t){return Math.floor(Math.random()*(t-e+1)+e)},oneRRQalwaysChecked=function(e){var t=0;for(var r in mPref.aPrefs.rrq_Notegroups)$("#prefRRQ_"+mPref.aPrefs.rrq_Notegroups[r][0]).is(":checked")&&t++;0==t&&$(e).prop("checked",!0)},makeUnabridgedDragDroppable=function(){$(".ngUnabDiv").draggable({helper:"clone",containment:"document",start:function(e,t){$(t.helper).addClass("ui-draggable-helper")},cursor:"move",tolerance:"fit",revert:!0}).click(function(){var e=this.id.split("_");set_notes_per_notegroup(e[0],e[1],e[2]),update_link()}),$("#ngDashboard").droppable({accept:".ngUnabDiv",activeClass:"drop-area",drop:function(e,t){if(""!=$(t.draggable)[0].id){{var r=t.helper.clone();t.helper.clone().context.id}t.helper.remove(),ctrl_addDashNotegroups(r.context.id),r.remove()}}}),$("#remove-drag").droppable({drop:function(e,t){$(t.draggable).remove()},hoverClass:"remove-drag-hover",accept:".remove"})},onDocReady=function(){};jQuery(document).ready(function(){populateColorPalleteChooser(),populateNotegroupsUnabridged(),$("#notegroupsUnabridged").tabs(),makeUnabridgedDragDroppable();for(var e in dictKeys)$("#ngTab_"+dictKeys[e].safename).tabs();$("#notegroupsUnabridged2").tabs(),$(".cNoteGroup").draggable({addClasses:!1}),$(gen_fret_boxes(GTR_FRETS,GTR_STRINGS)).insertAfter($("#mainfretboard")),GUITAR_STRINGS=getFretcloneStrings(),set_notes();var t=function(){for(var e="<tr>",t=$("#fretclone tr"),r=t[0].children,a=0;a<r.length;a++)e+='<td id="fretpaint_'+a+'" class="fretpainter"></td>';return e+="</tr>"};switch($("#fretclone > tbody:last").append(t),mPref=PrefModel,mPref.init(dictScales,GUITAR_STRINGS[0].length,GUITAR_STRINGS.length),$("#prefTabs").tabs(),mPref.aPrefs.startNoteLabel){case"note":$("input[name=sp_Label][value=note]").prop("checked",!0);break;case"int":$("input[name=sp_Label][value=int]").prop("checked",!0);break;default:$("input[name=sp_Label][value=note]").prop("checked",!0)}switch(mPref.aPrefs.startNoteColor){case"note":$("input[name=sp_Color][value=pallete]").prop("checked",!0);break;case"int":$("input[name=sp_Color][value=interval]").prop("checked",!0);break;default:$("input[name=sp_Color][value=pallete]").prop("checked",!0)}$("input[name=sp_Color][value=pallete]").prop("checked",!0);$("#spRIQ_LoFret").spinner({min:mPref.aPrefs.riq_LoFret,max:mPref.aPrefs.riq_HiFret-1,value:mPref.aPrefs.riq_LoFret,change:function(){this.value>=$("#spRIQ_HiFret").spinner("value")&&$("#spRIQ_LoFret").spinner("value",$("#spRIQ_HiFret").spinner("value")-1)}}),$("#spRIQ_HiFret").spinner({min:mPref.aPrefs.riq_LoFret+1,max:mPref.aPrefs.riq_HiFret,value:mPref.aPrefs.riq_HiFret,change:function(){this.value<=$("#spRIQ_LoFret").spinner("value")&&$("#spRIQ_HiFret").spinner("value",$("#spRIQ_LoFret").spinner("value")+1)}}),$("#spRIQ_StrDepth").spinner({min:0,max:mPref.aPrefs.riq_HiStr-1,value:mPref.aPrefs.riq_StrDepth}),$("#spRIQ_FretDepth").spinner({min:1,max:mPref.aPrefs.riq_HiFret-1,value:mPref.aPrefs.riq_FretDepth}),$("#spRR_LoFret").spinner({min:mPref.aPrefs.rrq_LoFret,max:mPref.aPrefs.rrq_HiFret-1,value:mPref.aPrefs.rrq_LoFret,change:function(){this.value>=$("#spRR_HiFret").spinner("value")&&$("#spRR_LoFret").spinner("value",$("#spRR_HiFret").spinner("value")+1)}}),$("#spRR_HiFret").spinner({min:mPref.aPrefs.rrq_LoFret+1,max:mPref.aPrefs.rrq_HiFret,value:mPref.aPrefs.rrq_HiFret,change:function(){this.value<=$("#spRR_LoFret").spinner("value")&&$("#spRR_HiFret").spinner("value",$("#spRR_LoFret").spinner("value")-1)}}),$("#spRR_LoStr").spinner({min:mPref.aPrefs.rrq_LoStr,max:mPref.aPrefs.rrq_HiStr,value:mPref.aPrefs.rrq_LoStr,change:function(){this.value>$("#spRR_HiStr").spinner("value")&&$("#spRR_HiStr").spinner("value",this.value)}}),$("#spRR_HiStr").spinner({min:mPref.aPrefs.rrq_LoStr,max:mPref.aPrefs.rrq_HiStr,value:mPref.aPrefs.rrq_HiStr,change:function(){this.value<$("#spRR_LoStr").spinner("value")&&$("#spRR_LoStr").spinner("value",this.value)}});mPref.retrieveUserPrefs(),populateNotegroupsRandRootTab(),ctl_setPrefFormToPrefModel();var r=get_url_parameters(),a=function(){if(is_defined(r.dash)){var e=r.dash;ctl_populateDash(e)}if(is_defined(r.diagram_title)&&$("#diagram_title").val(unescape(r.diagram_title)),is_defined(r.strings)&&(is_defined(r.q)&&"y"==r.q?(COLOR="black",$("#checkanswer").click(function(){check_answers(r.strings)}),ctl_updateQuizzing(ST_QUIZZING_URL)):fill_from_repr(r.strings)),is_defined(r.key)&&ctl_change_key.setRoot(getKeyObjFromSafeName(r.key)),is_defined(r.ng)){var t=!1,a=[];for(var n in Notegroups)Notegroups.hasOwnProperty(n)&&a.push(n);for(var i=0;i<a.length;i++)if(r.ng==a[i]){t=Notegroups[r.ng]}t&&set_notes_per_notegroup(mFB.getKeySafeName(),t.ngtype,t.varname)}};a(),update_link();var n=$("#message");$("#fretclone tr td").click(update_link),$("#diagram_title").change(update_link).keyup(update_link).keydown(update_link),$("#diagram_title").click(function(){this.select()}),$(".color_button").click(function(){COLOR=$(this).attr("class").split(" ")[1],n.html("")}),$(".fretpainter").click(function(){for(var e=this.id.split("_")[1],t=!1,r=0;r<GUITAR_STRINGS.length;r++){var a=$("#nc_"+r+"_"+e);if(is_painted(a)){t=!0;break}}for(var r=0;r<GUITAR_STRINGS.length;r++)if(t)td_clear($("#nc_"+r+"_"+e));else{{$("#nc_"+r+"_"+e)}COLORBYINTERVALS?ctl_color_td_by_interval(r,e):td_paint($("#nc_"+r+"_"+e),COLOR)}update_link()}),$(function(){$("#helpText").dialog({autoOpen:!1},{width:640,height:372},{dialogClass:".helpInstructions"})}),$("#btnHelp").button({text:!1,icons:{primary:"ui-icon-help"}}).click(function(){$("#helpText").html(HELP_TEXT),$("#helpText").dialog("open")}),$(function(){$("#prefWin").dialog({autoOpen:!1,modal:!0,buttons:{"Save and Close":function(){ctl_updatePrefs(),$(this).dialog("close")}}},{width:640,height:472},{dialogClass:".helpInstructions"})}),$("#btnPref").button({text:!1,icons:{primary:"ui-icon-gear"}}).click(function(){$("#prefWin").dialog("open")}),$("#brush").click(function(){var e=$(this).data("iteration")||1;switch(e){case 1:BRUSH=!0,ERASER=!1,$(this).removeClass("blank").addClass("white");break;case 2:$(this).removeClass("white").addClass("blank"),BRUSH=!1}e++,e>2&&(e=1),$(this).data("iteration",e)}),$("#eraser").click(function(){var e=$(this).data("iteration")||1;switch(e){case 1:ERASER=!0,BRUSH=!1,$(this).removeClass("blank").addClass("white");break;case 2:$(this).removeClass("white").addClass("blank"),ERASER=!1}e++,e>2&&(e=1),$(this).data("iteration",e)}),$("#clear").click(function(){n.html(""),clear_fretboard(),(QUIZZING==ST_QUIZZING_RANDOMROOT||QUIZZING==ST_QUIZZING_INTERVAL)&&ctl_updateQuizzing(ST_QUIZZING_NONE),update_link()}),$("#modeNoteInt").click(function(){INTERVALMODE=!INTERVALMODE,ctl_updateIntervalMode(INTERVALMODE),(QUIZZING==ST_QUIZZING_RANDOMROOT||QUIZZING==ST_QUIZZING_INTERVAL)&&ctl_updateQuizzing(ST_QUIZZING_NONE)}),$("#colorByInterval").click(function(){ctl_updateColorIntMode(COLORBYINTERVALS?!1:!0),(QUIZZING==ST_QUIZZING_RANDOMROOT||QUIZZING==ST_QUIZZING_INTERVAL)&&ctl_updateQuizzing(ST_QUIZZING_NONE)}),$("#setRoot").click(function(){SETTINGROOT=SETTINGROOT?!1:!0,updateSetRootView()}),$("#selKey").change(function(){ctl_change_key.selKeyChange($("#selKey").val()),(QUIZZING==ST_QUIZZING_RANDOMROOT||QUIZZING==ST_QUIZZING_INTERVAL)&&ctl_updateQuizzing(ST_QUIZZING_NONE)}),$("#dashPlayStop").click(function(){mPlayer.getPlaystate()==PS_PLAYING?ctl_stopPlayer():ctl_playPlayer()}),$("#dashBack").click(function(){ctl_backPlayer()}),$("#dashFwd").click(function(){ctl_fwdPlayer()}),$("#dashSpeed").change(function(){ctl_changeSpeed()}),$("#intervalQuiz").click(function(){$("#intervalQuiz").val()==CHECKANSWER?(ctl_updateQuizzing(ST_QUIZZING_NONE),ctl_updateIntervalMode(!0)):(ctl_updateIntervalMode(!1),ctl_updateQuizzing(ST_QUIZZING_INTERVAL))}),$("#randomRootQuiz").click(function(){ctl_updateQuizzing(ST_QUIZZING_NONE),ctl_updateQuizzing(ST_QUIZZING_RANDOMROOT)}),$("#examples ul li a").click(function(){r=get_url_parameters($(this).attr("href")),clear_fretboard(),a()}),$("#btnResetDefaults").click(function(){ctl_resetDefaultPrefs()}),"note"!=mPref.aPrefs.startNoteLabel&&(INTERVALMODE||($("#modeNoteInt").click(),$("input[name=sp_Label][value=int]").prop("checked",!0))),"pallete"!=mPref.aPrefs.startNoteColor&&(COLORBYINTERVALS||($("#colorByInterval").click(),$("input[name=sp_Color][value=interval]").prop("checked",!0))),is_defined(r.intColor)&&"true"==r.intColor&&ctl_updateColorIntMode(!0),is_defined(r.intNames)&&"true"==r.intNames&&ctl_updateIntervalMode(!0),is_defined(r.displayKey)&&$("#selKey").val(r.displayKey)});