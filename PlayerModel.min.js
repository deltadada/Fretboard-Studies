var PS_STOPPED="STOPPED",PS_PLAYING="PLAYING",PS_PAUSED="PS_PAUSED",DIR_FWD="FORWARD",DIR_BACK="BACKWARD",PlayerModel={aNoteGroupDivs:[],prevNG:"",i:0,playState:PS_STOPPED,looper:"",playSpeed:2e3,setNoteGroupDivs:function(t){this.aNoteGroupDivs=t},getNoteGroupDivs:function(){return this.aNoteGroupDivs},setPrevNG:function(t){this.prevNG=t},getPrevNG:function(){return this.prevNG},setPlaystate:function(t){this.playState=t},getPlaystate:function(){return this.playState},setLooper:function(t){this.looper=t},getLooper:function(){return this.looper},setPlaySpeed:function(t){this.playSpeed=Number(t),this.playState==PS_PLAYING&&(this.setPlaystate(PS_PAUSED),clearInterval(this.looper),this.setLooper(setInterval(function(){animateNotegroups(!0)},Number(t))),this.setPlaystate(PS_PLAYING))},getPlaySpeed:function(){return this.playSpeed},getNextNG:function(){var t=this.aNoteGroupDivs,e=t[this.i];return this.prevNG=e,this.i=(this.i+1)%this.aNoteGroupDivs.length,e},getNextNGBack:function(){var t=this.aNoteGroupDivs;this.prevNG=t[this.i],this.i=(this.i-1+this.aNoteGroupDivs.length)%this.aNoteGroupDivs.length;var e=t[this.i];return e},reloadNotegroups:function(t){this.aNoteGroupDivs=t.children().toArray(),this.i=0,this.prevNG=this.aNoteGroupDivs[this.aNoteGroupDivs.length-1]}},ctl_changeSpeed=function(){var t=Math.round(6e4/$("#dashSpeed").val());mPlayer.setPlaySpeed(t)},ctl_stopPlayer=function(){mPlayer.setPlaystate(PS_STOPPED),clearInterval(mPlayer.getLooper());var t=mPlayer.getNoteGroupDivs();for(var e in mPlayer.getNoteGroupDivs())$(t[e]).hasClass("playing")&&$(t[e]).removeClass("playing");$("#dashPlayStop").val("Play")},ctl_playPlayer=function(){$("#ngDashboard").children().length>1?(mPlayer.getPlaystate()!=PS_PAUSED&&mPlayer.reloadNotegroups($("#ngDashboard")),mPlayer.getPlaystate()==PS_PAUSED,mPlayer.setPlaystate(PS_PLAYING),$("#dashPlayStop").val("Stop"),0==mPlayer.i&&animateNotegroups(!0),mPlayer.setLooper(setInterval(function(){animateNotegroups(!0)},mPlayer.getPlaySpeed()))):ctl_stopPlayer()},ctl_pausePlayer=function(t){PS_PAUSED.direction=t,mPlayer.setPlaystate(PS_PAUSED),clearInterval(mPlayer.getLooper()),$("#dashPlayStop").val("Play")},ctl_backPlayer=function(){mPlayer.getPlaystate();ctl_pausePlayer(DIR_BACK),animateNotegroups(!1)},ctl_fwdPlayer=function(){mPlayer.getPlaystate();ctl_pausePlayer(DIR_FWD),animateNotegroups(!0)},animateNotegroups=function(t){if(t){var e=mPlayer.getPrevNG();""!=e&&$(e).hasClass("playing")&&$(e).removeClass("playing");var a=$(mPlayer.getNextNG());a.addClass("playing");var r=a.context.attributes.notegroup.value.split("_");set_notes_per_notegroup(r[0],r[1],r[2])}else{var a=$(mPlayer.getNextNGBack());a.addClass("playing");var r=a.context.attributes.notegroup.value.split("_");set_notes_per_notegroup(r[0],r[1],r[2]);var e=mPlayer.getPrevNG();""!=e&&$(e).hasClass("playing")&&$(e).removeClass("playing")}};